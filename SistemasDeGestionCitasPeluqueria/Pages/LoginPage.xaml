<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:conv="clr-namespace:SistemasDeGestionCitasPeluqueria.Converters"
             xmlns:pageModels="clr-namespace:SistemasDeGestionCitasPeluqueria.PageModels"
             xmlns:toolkit="http://schemas.microsoft.com/dotnet/2022/maui/toolkit"
             x:Class="SistemasDeGestionCitasPeluqueria.Pages.LoginPage"
             x:DataType="pageModels:LoginPageModel"
             Title="Iniciar sesión">

    <Grid>
        <!-- Fondo -->
        <Image Source="{Binding HeroImageUrl, Converter={StaticResource ImageSourceFromStringConverter}}"
               Aspect="AspectFill"
               AutomationProperties.IsInAccessibleTree="False" />

        <!-- Overlay oscuro ligero para mejorar contraste -->
        <BoxView Opacity="0.35" BackgroundColor="{DynamicResource Black}" />

        <!-- Contenedor centrado -->
        <VerticalStackLayout HorizontalOptions="Center"
                             VerticalOptions="Center"
                             Spacing="28">

            <!-- Encabezados -->
            <VerticalStackLayout Spacing="4"
                                 HorizontalOptions="Center">
                <Label Text="Barbería Premium"
                       FontAttributes="Bold"
                       FontSize="20"
                       TextColor="{DynamicResource White}"
                       HorizontalTextAlignment="Center" />
                <Label Text="Tu estilo, nuestra pasión"
                       FontSize="14"
                       TextColor="{DynamicResource White}"
                       Opacity="0.9"
                       HorizontalTextAlignment="Center" />
            </VerticalStackLayout>

            <!-- Tarjeta Login -->
            <Border Style="{StaticResource LoginCardBorderStyle}">
                <VerticalStackLayout Spacing="18">

                    <!-- Usuario -->
                    <VerticalStackLayout Spacing="6">
                        <Label Text="Usuario"
                               FontAttributes="Bold"
                               FontSize="12"
                               TextColor="{DynamicResource TextPrimary}" />
                        <Border Style="{StaticResource LoginInputBorderStyle}">
                            <Entry x:Name="UserEntry"
                                   Style="{StaticResource LoginEntryStyle}"
                                   Placeholder="juan.diaz"
                                   Text="{Binding Username}" />
                        </Border>
                    </VerticalStackLayout>

                    <!-- Contraseña -->
                    <VerticalStackLayout Spacing="6">
                        <Label Text="Contraseña"
                               FontAttributes="Bold"
                               FontSize="12"
                               TextColor="{DynamicResource TextPrimary}" />
                        <Border Style="{StaticResource LoginInputBorderStyle}">
                            <Entry x:Name="PasswordEntry"
                                   Style="{StaticResource LoginEntryStyle}"
                                   IsPassword="True"
                                   Placeholder="********"
                                   Text="{Binding Password}" />
                        </Border>
                    </VerticalStackLayout>

                    <!-- Botón -->
                    <Button x:Name="LoginButton"
                            Text="Entrar a la aplicación"
                            Style="{StaticResource LoginPrimaryButtonNoAccent}"
                            Command="{Binding LoginCommand}" />

                    <!-- Estado y errores -->
                    <ActivityIndicator IsRunning="{Binding IsBusy}"
                                       IsVisible="{Binding IsBusy}" />
                    <Label Text="{Binding Error}"
                           TextColor="{DynamicResource ErrorAlertText}"
                           FontAttributes="Bold"
                           HorizontalTextAlignment="Center" />

                    <!-- Registro: ahora enlazado al comando -->
                    <Button x:Name="RegisterButton"
                            Text="¿No tienes cuenta? Regístrate"
                            BackgroundColor="Transparent"
                            TextColor="{DynamicResource Accent}"
                            FontAttributes="Bold"
                            HorizontalOptions="Center"
                            Command="{Binding RegisterCommand}" />
                </VerticalStackLayout>
            </Border>
        </VerticalStackLayout>

        <!-- Botón ayuda -->
        <Button Text="?"
                HorizontalOptions="End"
                VerticalOptions="End"
                WidthRequest="36"
                HeightRequest="36"
                Margin="0,0,12,12"
                FontAttributes="Bold"
                BackgroundColor="{DynamicResource Primary}"
                TextColor="{DynamicResource White}"
                CornerRadius="18" />
    </Grid>
</ContentPage>